<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Golf Scorecard</title>
  <!--
    Golf Scorecard – Single-file HTML/CSS/JS
    Features:
    - Configure course name, number of players, and holes (9/12/18)
    - Edit PAR per hole at all times
    - Player strokes start at 0 and can be edited per hole
    - Out (front 9), In (back 9), and Total with ±Par
    - Yardage per hole (optional, editable)
    - Notes per hole (optional, editable)
    - Inline player name editing (chips)
    - Reset Scores to zero without regenerating
    - Export/Import JSON state
    - Print-friendly styling
    - Robust Generate handler + Auto-generate on page load
  -->
  <style>
    /* ==========================
       THEME & BASE STYLES
       ========================== */
    :root {
      --bg:#0b1320;
      --panel:#121a2b;
      --muted:#7b8bb2;
      --text:#e8edf8;
      --accent:#4cc38a;
      --accent-2:#7c9cff;
      --danger:#ff6b6b;
      --card:#0f172a;
      --ring:#3b82f6;
      --border:#23304a;
    }
    * { box-sizing:border-box; }
    html, body { height:100%; }
    body {
      margin:0;
      font-family:system-ui,Segoe UI,Roboto,Ubuntu,Inter,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.4;
    }
    header {
      position:sticky;
      top:0;
      background:linear-gradient(180deg,var(--panel),rgba(18,26,43,.9));
      backdrop-filter:blur(6px);
      z-index:5;
      border-bottom:1px solid var(--border);
    }
    .wrap { max-width:1200px; margin:0 auto; padding:16px; }
    h1 { margin:0 0 8px; font-size:clamp(20px,3vw,28px); }
    .muted { color:var(--muted); }.card {
  background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));
  border:1px solid var(--border);
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
.panel { padding:16px; }
.grid { display:grid; gap:12px; }
.grid.cols-4 { grid-template-columns:repeat(4,minmax(0,1fr)); }

label { font-size:13px; color:var(--muted); display:block; margin-bottom:6px; }
input, select, textarea {
  width:100%;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  outline:0;
  transition:border .15s, box-shadow .15s;
}
input:focus, select:focus, textarea:focus {
  border-color:var(--ring);
  box-shadow:0 0 0 3px rgba(59,130,246,.25);
}

.btn {
  border:1px solid var(--border);
  background:var(--card);
  color:var(--text);
  padding:10px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}
.btn.primary {
  background:linear-gradient(180deg,var(--accent-2),#4e7dfc);
  border-color:#375fde;
  color:#fff;
}
.btn.danger {
  background:linear-gradient(180deg,#ff7a7a,#e04646);
  border-color:#b83030;
  color:#fff;
}
.btn:disabled { opacity:.5; cursor:not-allowed; }

.table-wrap { overflow:auto; margin-top:12px; }
table {
  border-collapse:separate;
  border-spacing:0;
  width:max-content;
  min-width:100%;
  background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));
  border:1px solid var(--border);
  border-radius:12px;
  overflow:hidden;
}
th, td {
  padding:8px 10px;
  border-bottom:1px solid var(--border);
  text-align:center;
  vertical-align:top;
}
thead th { position:sticky; top:0; background:var(--panel); z-index:2; }
tbody tr:hover td { background:rgba(255,255,255,.03); }
tfoot td { background:rgba(255,255,255,.03); font-weight:700; }

.left { text-align:left; }
.hole-input { width:56px; }
.name-input { min-width:160px; }
.note-input { min-width:120px; font-size:12px; }
.par-good { color:var(--accent); }
.par-bad { color:var(--danger); }

.chip {
  display:inline-block;
  padding:2px 8px;
  border-radius:999px;
  font-size:12px;
  border:1px solid var(--border);
  background:var(--card);
  cursor:text;
}
.players-bar { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
.players-bar .chip { min-width:60px; text-align:center; }

.footer { display:flex; justify-content:space-between; align-items:center; margin-top:14px; gap:8px; }
.totals { display:flex; gap:12px; flex-wrap:wrap; }
.totals .card { padding:10px 12px; }

/* PRINT STYLES */
@media print {
  header, .no-print { display:none; }
  body { background:#fff; color:#000; }
  .card, table, th, td { border-color:#ddd; }
}

  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Golf Scorecard</h1>
      <div class="muted">
        Configure players, edit pars anytime, add notes, record strokes, and see summaries.
      </div>
    </div>
  </header>  <main class="wrap">
    <!-- Setup Card -->
    <section class="card panel" id="setup">
      <div class="grid cols-4">
        <div>
          <label for="course">Course name</label>
          <input id="course" type="text" placeholder="e.g., St Andrews" />
        </div>
        <div>
          <label for="players">Players</label>
          <input id="players" type="number" min="1" max="8" value="2" />
        </div>
        <div>
          <label for="holes">Holes</label>
          <select id="holes">
            <option value="18" selected>18</option>
            <option value="9">9</option>
            <option value="12">12</option>
          </select>
        </div>
        <div style="align-self:end">
          <button class="btn primary" id="generate">Generate Scorecard</button>
        </div>
      </div>
      <div class="row" style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn danger no-print" id="resetScores">Reset Scores</button>
        <button class="btn no-print" id="exportJson">Export JSON</button>
        <input type="file" id="importJson" accept="application/json" style="display:none" />
        <button class="btn no-print" id="importBtn">Import JSON</button>
      </div>
      <div class="hint muted" style="margin-top:8px; font-size:12px;">Tip: click a player name chip to edit it. Use arrow keys to move across holes quickly.</div>
    </section><section class="card panel" id="playersBar" style="display:none"></section>
<section class="card panel" id="workspace" style="margin-top:14px"></section>
<section class="card panel" id="summary" style="margin-top:14px"></section>

<div class="footer no-print">
  <div class="totals" id="footerTotals"></div>
  <div style="display:flex; gap:8px; flex-wrap:wrap; align-items:center;">
    <button class="btn" id="saveCsv">Save CSV</button>
    <button class="btn" id="saveHtml">Save HTML Snapshot</button>
    <button class="btn" onclick="window.print()">Print</button>
  </div>
</div>
  <button class="btn" onclick="window.print()">Print</button>
</div>

  </main>  <script>
    (function(){
      // --------- Helpers & Elements ---------
      const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));
      const el = id => document.getElementById(id);
      const $course = el('course');
      const $players = el('players');
      const $holes = el('holes');
      const $generate = el('generate');
      const $workspace = el('workspace');
      const $summary = el('summary');
      const $playersBar = el('playersBar');
      const $resetScores = el('resetScores');
      const $exportJson = el('exportJson');
      const $importJson = el('importJson');
      const $importBtn = el('importBtn');
      const $footerTotals = el('footerTotals');
      const $saveCsv = el('saveCsv');
      const $saveHtml = el('saveHtml');

      // --------- App State ---------
      let state = {
        courseName: '',
        numPlayers: 2,
        numHoles: 18,
        playerNames: ["Player 1","Player 2"],
        par: [],         // per-hole par
        yardages: [],    // per-hole yardage (optional)
        notes: [],       // per-hole notes (optional)
        scores: []       // [player][hole]
      };

      // --------- Setup Handlers ---------
      $generate.addEventListener('click', () => {
        const np = parseInt($players.value || '2', 10);
        const nh = parseInt($holes.value || '18', 10);

        state.courseName = ($course.value || '').trim();
        state.numPlayers = isNaN(np) ? 2 : clamp(np, 1, 8);
        state.numHoles   = isNaN(nh) ? 18: clamp(nh, 3, 27);

        // Keep existing values when possible (so edits aren't lost on re-generate)
        state.playerNames = Array.from({ length: state.numPlayers }, (_, i) => state.playerNames?.[i] || `Player ${i+1}`);
        state.par        = Array.from({ length: state.numHoles }, (_, i) => (state.par?.[i] ?? 0));
        state.yardages   = Array.from({ length: state.numHoles }, (_, i) => state.yardages?.[i] ?? 0);
        state.notes      = Array.from({ length: state.numHoles }, (_, i) => state.notes?.[i] ?? "");
        state.scores     = Array.from({ length: state.numPlayers }, (__ , p) =>
                              Array.from({ length: state.numHoles }, (_ , h) => state.scores?.[p]?.[h] ?? 0)
                            );

        renderAll();
      });

      $resetScores.addEventListener('click', () => {
        state.scores = Array.from({ length: state.numPlayers }, () =>
                         Array.from({ length: state.numHoles }, () => 0)
                       );
        renderAll();
      });

      $exportJson.addEventListener('click', () => {
        const blob = new Blob([JSON.stringify(state, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `golf-scorecard-${Date.now()}.json`;
        a.click();
        URL.revokeObjectURL(url);
      });
      $importBtn.addEventListener('click', () => $importJson.click());
      $importJson.addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;
        try {
          const txt = await file.text();
          const data = JSON.parse(txt);
          state = { ...state, ...data };
          // Ensure required array lengths
          state.playerNames = Array.from({ length: state.numPlayers }, (_, i) => state.playerNames?.[i] || `Player ${i+1}`);
          state.par        = Array.from({ length: state.numHoles }, (_, i) => (state.par?.[i] ?? 0));
          state.yardages   = Array.from({ length: state.numHoles }, (_, i) => state.yardages?.[i] ?? 0);
          state.notes      = Array.from({ length: state.numHoles }, (_, i) => state.notes?.[i] ?? "");
          state.scores     = Array.from({ length: state.numPlayers }, (__ , p) =>
                                Array.from({ length: state.numHoles }, (_ , h) => state.scores?.[p]?.[h] ?? 0)
                              );
          renderAll();
        } catch (err) {
          alert('Invalid JSON file.');
        }
        $importJson.value='';
      });

      // --------- Computations ---------
      function computeTotals(pIdx){
        const strokes = state.scores[pIdx] || [];
        const total = strokes.reduce((a,b)=>a+(+b||0),0);
        const parTotal = state.par.reduce((a,b)=>a+(+b||0),0);
        const front9 = strokes.slice(0,9).reduce((a,b)=>a+(+b||0),0);
        const back9  = strokes.slice(9).reduce((a,b)=>a+(+b||0),0);
        return { total, toPar: total - parTotal, front9, back9 };
      }
      function computeParTotals(){
        const total = state.par.reduce((a,b)=>a+(+b||0),0);
        const front9 = state.par.slice(0,9).reduce((a,b)=>a+(+b||0),0);
        const back9  = state.par.slice(9).reduce((a,b)=>a+(+b||0),0);
        return { total, front9, back9 };
      }

      // --------- Rendering ---------
      function renderAll(){
        renderPlayersBar();
        renderWorkspace();
        renderSummary();
        renderFooterTotals();
      }

      function renderPlayersBar(){
        if(!state.courseName && !state.playerNames.length){ $playersBar.style.display='none'; return; }
        $playersBar.style.display='block';
        $playersBar.innerHTML = `
          <div class="row" style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
            <div>
              <div class="muted">Course</div>
              <div style="font-weight:700">${state.courseName || '—'}</div>
            </div>
            <div style="flex:1"></div>
            <div>
              <div class="muted">Players</div>
              <div class="players-bar" id="playersChips"></div>
            </div>
          </div>`;
        const chips = $playersBar.querySelector('#playersChips');
        chips.innerHTML='';
        state.playerNames.forEach((name,idx)=>{
          const span=document.createElement('span');
          span.className='chip';
          span.contentEditable='true';
          span.textContent=name;
          span.title='Click to edit player name';
          span.addEventListener('blur',()=>{
            const v=(span.textContent||'').trim() || `Player ${idx+1}`;
            state.playerNames[idx]=v;
            renderSummary();
            renderFooterTotals();
          });
          chips.appendChild(span);
        });
      }

      function renderWorkspace(){
        const holes = state.numHoles;
        const headerHoles = Array.from({length:holes},(_,i)=>`<th>H${i+1}</th>`).join('');
        const parInputs = Array.from({length:holes},(_,h)=>
          `<td><input class="hole-input" type="number" min=\"0\" max=\"6\" value=\"${state.par[h]}\" data-role=\"par\" data-h="${h}" /></td>`
        ).join('');
        const yardInputs = Array.from({length:holes},(_,h)=>
          `<td><input class="hole-input" type="number" min="0" max="800" value="${state.yardages[h]}" data-role="yard" data-h="${h}" /></td>`
        ).join('');
        const noteInputs = Array.from({length:holes},(_,h)=>
          `<td><textarea class="note-input" data-role="note" data-h="${h}">${state.notes[h]||''}</textarea></td>`).join('');

    const playerRows = state.playerNames.map((name,pIdx)=>{
      const tds = Array.from({length:holes},(_,h)=>{
        const v = state.scores[pIdx]?.[h] ?? 0;
        return `<td><input class=\"hole-input\" type=\"number\" min=\"0\" max=\"15\" value=\"${v}\" data-role=\"stroke\" data-p=\"${pIdx}\" data-h=\"${h}\" /></td>`;
      }).join('');
      const {total,toPar,front9,back9} = computeTotals(pIdx);
      const cls = toPar<0? 'par-good' : (toPar>0? 'par-bad' : '');
      return `<tr>
        <td class="left">${name}</td>
        ${tds}
        <td>${front9}</td>
        <td>${back9}</td>
        <td><span class="${cls}">${total} (${toPar>=0?'+':''}${toPar})</span></td>
      </tr>`;
    }).join('');

    const parTotals = computeParTotals();

    $workspace.innerHTML = `
      <h3>${state.courseName || ''}</h3>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th class="left">Player</th>
              ${headerHoles}
              <th>Out</th>
              <th>In</th>
              <th>Total (±Par)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="left muted">Par</td>
              ${parInputs}
              <td>${parTotals.front9}</td>
              <td>${parTotals.back9}</td>
              <td>${parTotals.total}</td>
            </tr>
            <tr>
              <td class="left muted">Yardage</td>
              ${yardInputs}
              <td colspan="3"></td>
            </tr>
            <tr>
              <td class="left muted">Notes</td>
              ${noteInputs}
              <td colspan="3"></td>
            </tr>
            ${playerRows}
          </tbody>
        </table>
      </div>`;

    // Bind interactions for par/yardage/notes/strokes
    $workspace.querySelectorAll('input[data-role="par"]').forEach(inp=>{
      inp.addEventListener('input',()=>{
        const h = parseInt(inp.dataset.h,10);
        state.par[h] = clamp(parseInt(inp.value||'0',10), 0, 20);
        renderWorkspace();
        renderSummary();
        renderFooterTotals();
      });
    });
    $workspace.querySelectorAll('input[data-role="yard"]').forEach(inp=>{
      inp.addEventListener('input',()=>{
        const h = parseInt(inp.dataset.h,10);
        state.yardages[h] = clamp(parseInt(inp.value||'0',10), 0, 1000);
      });
    });
    $workspace.querySelectorAll('textarea[data-role="note"]').forEach(inp=>{
      inp.addEventListener('input',()=>{
        const h = parseInt(inp.dataset.h,10);
        state.notes[h] = inp.value;
      });
    });
    $workspace.querySelectorAll('input[data-role="stroke"]').forEach(inp=>{
      inp.addEventListener('input',()=>{
        const p = parseInt(inp.dataset.p,10);
        const h = parseInt(inp.dataset.h,10);
        state.scores[p][h] = clamp(parseInt(inp.value||'0',10), 0, 30);
        renderWorkspace();
        renderSummary();
        renderFooterTotals();
      });
    });
  }

  function renderSummary(){
    const parTotal = state.par.reduce((a,b)=>a+(+b||0),0);
    const rows = state.playerNames.map((name,p)=>{
      const { total, toPar, front9, back9 } = computeTotals(p);
      const cls = toPar<0? 'par-good' : (toPar>0? 'par-bad' : '');
      return `<tr>
        <td class="left">${name}</td>
        <td>${front9}</td>
        <td>${back9}</td>
        <td>${total}</td>
        <td>${parTotal}</td>
        <td class="${cls}">${toPar>=0?'+':''}${toPar}</td>
      </tr>`;
    }).join('');

    $summary.innerHTML = `
      <h3>Summary</h3>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th class="left">Player</th>
              <th>Out</th>
              <th>In</th>
              <th>Total</th>
              <th>Par</th>
              <th>±Par</th>
            </tr>
          </thead>
          <tbody>${rows}</tbody>
        </table>
      </div>`;
  }

  function renderFooterTotals(){
    const par = computeParTotals().total;
    const cards = state.playerNames.map((name,p)=>{
      const { total, toPar } = computeTotals(p);
      const tag = toPar>0? `+${toPar}` : `${toPar}`;
      const cls = toPar<0? 'par-good' : (toPar>0? 'par-bad' : '');
      return `<div class="card">
        <div class="muted" style="font-size:12px">Totals</div>
        <div style="font-weight:700">${name}</div>
        <div class="muted">${total} / Par ${par} (<span class="${cls}">${tag}</span>)</div>
      </div>`;
    }).join('');
    $footerTotals.innerHTML = cards;
  }

  // --------- Saving helpers ---------
  function download(filename, text, type='text/plain'){
    const blob = new Blob([text], {type});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = filename; a.click();
    URL.revokeObjectURL(url);
  }
  function buildCSV(){
    const holes = state.numHoles;
    const header = ['Player', ...Array.from({length:holes},(_,i)=>`H${i+1}`), 'Out','In','Total','Par','±Par'];
    const lines = [];
    lines.push(header.join(','));
    // Par row
    const parTotals = computeParTotals();
    lines.push(['Par', ...state.par, parTotals.front9, parTotals.back9, parTotals.total, parTotals.total, 0].join(','));
    // Players
    state.playerNames.forEach((name,p)=>{
      const front9 = state.scores[p].slice(0,9).reduce((a,b)=>a+(+b||0),0);
      const back9  = state.scores[p].slice(9).reduce((a,b)=>a+(+b||0),0);
      const total  = front9 + back9;
      const parT   = parTotals.total;
      const toPar  = total - parT;
      lines.push([name, ...state.scores[p], front9, back9, total, parT, toPar].join(','));
    });
    // Yardage row
    lines.push(['Yardage', ...state.yardages].join(','));
    // Notes row (notes may contain commas/newlines; replace with spaces)
    lines.push(['Notes', ...state.notes.map(n=>(n||'').replace(/[

,]/g,' '))].join(',')); return lines.join(' '); } function buildSnapshotHtml(){ const dateStr = new Date().toLocaleString(); return <!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Scorecard Snapshot</title><style>body{font-family:system-ui,Segoe UI,Roboto,Ubuntu,Inter,Arial,sans-serif;padding:20px;line-height:1.4}h1{margin:0 0 8px}h3{margin-top:24px}.muted{color:#555}.table-wrap{overflow:auto;margin-top:8px}table{border-collapse:collapse;width:max-content;min-width:100%}th,td{border:1px solid #ccc;padding:6px 8px;text-align:center}th.left,td.left{text-align:left}</style></head><body><h1>${state.courseName||'Scorecard'}</h1><div class="muted">Saved ${dateStr}</div>${$workspace.innerHTML}${$summary.innerHTML}</body></html>; } $saveCsv?.addEventListener('click', ()=>{ download(scorecard-${Date.now()}.csv, buildCSV(), 'text/csv'); }); $saveHtml?.addEventListener('click', ()=>{ download(scorecard-${Date.now()}.html, buildSnapshotHtml(), 'text/html'); });

// --------- Auto-generate on page load ---------
  window.addEventListener('load', () => {
    // Trigger a default card so users immediately see a table
    if (!$workspace.innerHTML.trim()) {
      $generate.click();
    }
  });
})();

  </script>
</body>
  </html>
